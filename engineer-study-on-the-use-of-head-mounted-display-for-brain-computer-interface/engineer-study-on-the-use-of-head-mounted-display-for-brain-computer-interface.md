# Engineering study on the use of Head-Mounted display for Brain-Computer Interface
https://arxiv.org/pdf/1906.12251.pdf

## Abstract
- HMD(VR)デバイスは脳波を用いるP300ベースのBCIと相性が良い
  - [P300](http://www2.oninet.ne.jp/ts0905/human/p300.htm): 互いに識別可能な2種類以上の感覚刺激(聴覚・視覚・体性感覚・臭覚・味覚などなど)をランダムに呈示し、低頻度の刺激を選択的に注意させることによって、刺激後約250～500msec(論文では300msと記載)という長潜時で出現する陽性電位
- HMDに現れる刺激を完全に脳波信号の取得と同期させる必要がある
  - これをtaggingと呼ばれるプロセスにより解決する
  - taggingはP300の検知とBCIのパフォーマンスを保証するべく信頼があり頑強な方法でなされる必要がある
- HMDデバイスは正確に刺激を知覚するため、また脳の取得が乱雑にならないよう十分早く画像を表示させられるようすべき
- 手頃な価格のHMDデバイスが、両者(HMD上の刺激/脳波)の研究と実験目的で必要である
- ここでは二つのHMD構成を選択し、検証した

## Introduction
- 近年VRは人気のエンターテイメントとなった
- 同時期にBCIのための新たなアルゴリズムがより速いbits/minコミュニケーションを考慮して開発されてきた
- VR + VCIは以前も行われてきたが、VRとBCIインターフェースのパフォーマンスに影響を与えるため対処しなければならない技術的課題を多く抱えていた。
- 市場はより広い範囲のVRを求めている(図1は網羅的では無いが、VRデバイスの分類)
- [CAVE(Cave Automatic Virtual Enviroment)](https://ja.wikipedia.org/wiki/Cave_automatic_virtual_environment): 大きすぎ、一般目的では使いにくい
- 家庭で使えるVRデバイスのグループ
  - PCとリンクしたデバイス: PCとケーブルを通してリンクし、PCが全てのソフトウェアと画像のレンダリングを実行する
    - 例: Oculus, HTC Viveなど
- デスクトップPCと接続しないグループ
  - Active HMDs: 電子機器を含む
    - 例: SamsungGear, Oculus Quest
  - Passive HMD: 電子機器を含まない
    - 例: Google Cardboard
    - mobile HMD: スマートフォンを挿入して使う
    - 多くのマスクとスマートフォンがあるが互換性があるとは限らない

- Linked-to-PCヘッドセットとactive HMDのどちらを選ぶべきか議論
- VRElegiantマスクの利用を勧める
- 二種類のスマートフォンで検証
  - Huawei mate 7
  - Samsung S6

## Why Linked-to-PC headset and Mobile Active HMD are not suitable
- なぜLinked-to-PCヘッドセットとMobile Active HMDが適さないか
- Linked-to-PCヘッドセットは内部カメラと外部カメラを用いた位置のトラックシステムを含んでいる
  - この技術は正確にユーザーの位置を捉え。IMUによりdrift(IMUが不正確であると仮想世界でゆっくりとユーザーの周りを移動してしまう現象)を修正する
  - OculusとHTC Viveの最初のバージョンはユーザーの位置をトラックするために外部のキャプチャを用いている
  - ただしこれらの技術はDaydream frameworkのようなinside-out trackingに置き換えられる傾向がある
  - inside-out trackingはセンサーフュージョン(複数のセンサにより新情報を抽出する方法)アルゴリズムをベースとしており、IMU driftを修正するべくカメラからのデータのインプットを含んでいる
  - この技術にはいくつかの問題がある
    - 視界を制限される
    - 仮想世界の物体やユーザーの位置を見失う
    - ゲームのエリアを制限される
    - 現実世界のイベントを検出できない
      - ARアプリケーションの重要な側面
  - Oculus Questがこの技術をベースとした唯一効果的なMobile Active HMD

- Linked-to-PC VRデバイスはいくつかのデメリットがある
  - ケーブルを必要とし、動きを制限される
  - パワフルなPCが必要だが、高価である
- Mobile Active HMDもデメリットがある
  - proprietary（？）: 規格が統一されてない？
  - Mobile Passive HMDよりも高価である
- また現時点でActive HMD内の電子機器の脳波信号への影響は研究されてない

## Why the VRElegiant
- Mobile Passive HMDはマスク内に通常のスマートフォン以外の電子機器を含んでおらず、広く普及する可能性がある
- これらのゴーグルの中でVRElegiantヘッドセットは価格が手頃で、快適であり、またスマートフォンにも広く対応している
  - またUSBケーブルを追加することも簡単で、視野角は96度である

## Evaluation
- P300ベースのBCIは画面に表示された視覚刺激の開始を正確に脳波にタグ付けする必要がある
  - 謝ってタグ付けすると遅延とjitterが発生する
   - jitterは遅延の標準偏差
- HMD内のスマートフォンと脳波取得システムとの低jitter通信が必要
  - 二つのデバイスの間でUSB経由のハードウェア通信をした方が良い
  - これはUSBタギ付けとして知られており、以下でのデバイスで成功している
    - VRElegiantとHuawei Mate 7(1920 x 1080の大画面もある)
    - SamsungGearヘッドセットとSamsung S6(2560 x  1440もある)

- SamsungGearではUSBポートが利用できなかったため、刺激ごとにスマートフォンのトーチライトを点滅させることによる通信方法を検討
  - EEG取得システムのフォトダイオードにより物理的なフラッシュは数値タグ（フラッシュあり/なし）に変換される
  - USBタギ付けよりも堅牢性が低く、フラッシュの一部を失う可能性がある
  - またUSBタギ付けよりも高いjitterが発生する
  - 図4を参照する

- フォトダイオードとUSB(あるいはトーチライト)タグ付けがEEGアンプによってそれぞれ記録され、同期している。
- アンプは16-channel g.USBampであり、512Hzの周波数を用いており、OpenVibeというソフトで記録している
- VRでは画面が二つに分割され、異なる目にテクスチャを与える。
- 眼球間での遅延が長かった時、二つの刺激の知覚となる
- したがって可能な限り、二つの画面での差異が小さいものを用いた
- 一般的に、眼球間での遅延が小さい場合、大きな平均遅延も許容されうる
  - EEG信号をシフトすれば良い
- しかし高いjitterの場合は問題を解決できない
  - 高いjitterを解決するため以下の策をとった
    - スマートフォンを機内モードに切り替え
    - 非同期メッセージを無効に
    - テクスチャ解像度を8で割る
    - アンチエイリアシングを抑制
    - texture distortion shaderを削除
    - 画面の左右で重複していた時、レンダリング前後の操作を分解した
      - Samsung S6の画面の右側ではこれらの操作によりjitterを11.8から6.01まで下げることができた
- 図4よりHuwei mates 7の画面間の差が最も小さいことがわかった。

## Discussion and Conclusion
- P300ベースのBCIと特定のjitter通信のためのVRデバイスの有用性について調査
- 今回おこなった検証では手頃な価格のMobile Passive HMDを選択
- テストの結果、VRモードでは最適化を行なった後でもPCモードと比べてかなりの遅延があることがわかった
- VRモードの性質上、画面が分割されているので両方の目でjitterをテストする必要がある。

- Mobile HMDのUSBタグ付けはWi-FIタグ付けよりも良い結果をもたらし、トーチライトよりも堅牢だが、余分なUSBケーブルを必要とする欠点がある
- タグにタイムスタンプを置き、スマートフォンとアンプを一定の間隔で同期させる方法としてWifiタグ付けをさらに研究する必要がある
- g.USBampは記録された信号のサンプルにタイムスタンプを提供しないのでこれらをテストすることができなかった
- タイムスタンプの機能は既存の実装に適合しうる

- 最近研究ではMobile Passive HMDを使用してもEEG信号が影響を受けないことを示している
- VRとBCIを融合させる技術の将来は明るい
- OpenBCIのような高品質で、低コストのEEGモバイルデバイスが多く開発されている
- 研究実績や手頃な価格でオープンなEEGを提供するための研究が行われている(http://eeg.io)
- これらのヘッドセットと、低コストのHMDデバイスを組み合わせることでVR+BCIアプリケーションを幅広く普及させることに繋げられる
